<%- include('../partials/header', { title: title }) %>

<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h4 mb-0">My Students</h1>
    <a href="/teachers/students/add" class="btn btn-primary">
      <i class="bi bi-person-plus me-1"></i> Add Student
    </a>
  </div>

  <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-danger"><%= error %></div>
  <% } %>

  <% if (!students || students.length === 0) { %>
    <div class="text-center text-muted py-5">No students yet. Click "Add Student" to create one.</div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>Name</th>
            <th>Grade/Section</th>
            <th>Parent</th>
            <th>Events</th>
            <th>Pending</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% students.forEach(s => { %>
            <tr>
              <td><strong><%= s.first_name %> <%= s.last_name %></strong><br>
                <small class="text-muted">ID: <%= s.student_id %></small>
              </td>
              <td><%= s.grade %><% if (s.section) { %> - <%= s.section %><% } %></td>
              <td>
                <div><%= s.parent_name || '—' %></div>
                <small class="text-muted"><%= s.parent_email || '' %><% if (s.parent_phone) { %> · <%= s.parent_phone %><% } %></small>
              </td>
              <td><span class="badge bg-info"><%= s.event_count || 0 %></span></td>
              <td><span class="badge bg-warning text-dark"><%= s.pending_payments || 0 %></span></td>
              <td>
                <a href="/teachers/students/<%= s.id %>/edit" class="btn btn-sm btn-outline-primary">
                  <i class="bi bi-pencil"></i>
                </a>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>

<%- include('../partials/footer') %>

